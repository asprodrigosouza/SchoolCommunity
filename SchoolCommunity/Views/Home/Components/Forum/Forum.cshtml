@model SchoolCommunity.Models.ViewModels.ForumVM

<div class="row clearfix">

    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="idDivPrincipalForumDeDuvidas">
        <div class="card">
            <div class="header bg-light-green">
                <h2>
                    Forúm de Dúvidas
                </h2>
                <div class="button-demo js-modal-buttons">
                    <button type="button" data-color="indigo" class="btn bg-indigo waves-effect" style="margin-top:1%;font-size:30px;"><i class="material-icons" style="font-size:30px;">add_circle_outline</i> Perguntar</button>
                </div>
                <ul class="header-dropdown m-r--5">
                    <li>
                        <a href="javascript:void(0);" data-toggle="cardloading" data-loading-effect="rotation" data-loading-color="lightGreen">
                            <i class="material-icons">loop</i>
                        </a>
                    </li>
                    <li class="dropdown">
                        <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            <i class="material-icons">more_vert</i>
                        </a>
                        <ul class="dropdown-menu pull-right">
                            <li><a href="javascript:void(0);">Action</a></li>
                            <li><a href="javascript:void(0);">Another action</a></li>
                            <li><a href="javascript:void(0);">Something else here</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="body">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active">
                        <a href="#topicos_recentes" data-toggle="tab">
                            <i class="material-icons">date_range</i> TÓPICOS RECENTES
                        </a>
                    </li>
                    <li role="presentation">
                        <a href="#profile_with_icon_title" data-toggle="tab">
                            <i class="material-icons">face</i> SEM RESPOSTA
                        </a>
                    </li>
                    @*<li role="presentation">
                            <a href="#messages_with_icon_title" data-toggle="tab">
                                <i class="material-icons">email</i> MESSAGES
                            </a>
                        </li>
                        <li role="presentation">
                            <a href="#settings_with_icon_title" data-toggle="tab">
                                <i class="material-icons">settings</i> SETTINGS
                            </a>
                        </li>*@
                </ul>

                <!-- Tab panes -->
                <div class="tab-content">

                    <!-- Listar Perguntas Recentes -->
                    <div role="tabpanel" class="tab-pane fade in active" id="topicos_recentes">
                        @*@foreach (SchoolCommunity.Models.Forum pergunta in Model._listaPerguntasRecentes)
                         {
                            <a href="#" onclick="ExecutarAbrirModalPergunta('@pergunta.Pergunta.IdPergunta');">
                                <div class="card">
                                    <div class="header bg-light-green demo-color-box sombreamento">
                                        <h2>
                                            @pergunta.Pergunta.TituloPergunta <small><i>@pergunta.Pergunta.AutorUsuarioPergunta</i></small>
                                        </h2>
                                        <small>@pergunta.Pergunta.DataHoraRealizacaoPergunta</small>
                                    </div>
                                </div>
                            </a>
                         }*@
                    </div>

                    <!-- Listar Perguntas sem Respostas -->
                    <div role="tabpanel" class="tab-pane fade" id="profile_with_icon_title">
                        @*@foreach (var perguntasSemRespostas in Model._listaPerguntasSemRespostas)
                         {
                            <a href="#" onclick="ExecutarAbrirModalPergunta('@perguntasSemRespostas.Pergunta.IdPergunta')">
                                <div class="card">
                                    <div class="header bg-light-green demo-color-box sombreamento">
                                        <h2>
                                            @perguntasSemRespostas.Pergunta.TituloPergunta <small><i>@perguntasSemRespostas.Pergunta.AutorUsuarioPergunta</i></small>
                                        </h2>
                                        <small>@perguntasSemRespostas.Pergunta.DataHoraRealizacaoPergunta</small>
                                    </div>

                                </div>
                            </a>
                         }*@
                    </div>

                    @*<div role="tabpanel" class="tab-pane fade" id="messages_with_icon_title">
                            <b>Message Content</b>
                            <p>
                                Lorem ipsum dolor sit amet, ut duo atqui exerci dicunt, ius impedit mediocritatem an. Pri ut tation electram moderatius.
                                Per te suavitate democritum. Duis nemore probatus ne quo, ad liber essent aliquid
                                pro. Et eos nusquam accumsan, vide mentitum fabellas ne est, eu munere gubergren
                                sadipscing mel.
                            </p>
                        </div>
                        <div role="tabpanel" class="tab-pane fade" id="settings_with_icon_title">
                            <b>Settings Content</b>
                            <p>
                                Lorem ipsum dolor sit amet, ut duo atqui exerci dicunt, ius impedit mediocritatem an. Pri ut tation electram moderatius.
                                Per te suavitate democritum. Duis nemore probatus ne quo, ad liber essent aliquid
                                pro. Et eos nusquam accumsan, vide mentitum fabellas ne est, eu munere gubergren
                                sadipscing mel.
                            </p>
                        </div>*@

                </div>
            </div>

        </div>
    </div>

</div>

<!-- MODAL - + Perguntar -->
<div class="modal fade" id="idModalPerguntar" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="defaultModalLabel">QUERO PERGUNTAR</h4>
            </div>

            <div class="modal-body">
                <!-- Campo Título da Pergunta -->
                <div class="form-group">
                    <div class="form-line">
                        <label>Título:</label>
                        <input id="idTituloPerguntaForum" type="text" class="form-control" placeholder="Digite aqui o título da pergunta" />
                    </div>
                </div>

                <!-- Campo TextArea Descrição da Pergunta -->
                <div class="row clearfix">
                    <div class="col-sm-12">
                        <div class="form-group">
                            <div class="form-line">
                                <label>Descrição:</label>
                                <textarea id="idDescricaoPerguntaForum" rows="7" class="form-control no-resize" placeholder="Digite aqui o conteúdo da pergunta"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Campo Tags -->
                <div class="form-group demo-tagsinput-area">
                    <div class="form-line">
                        <label>Tags (Ex: Matemática):</label>
                        <br />
                        <input id="idTagsPerguntaForum" type="text" class="form-control" data-role="tagsinput" />
                    </div>
                </div>

                <!-- Campo Tags -->
                @*<div class="row clearfix">
                        <div class="col-sm-12">
                            <div class="form-group demo-tagsinput-area">
                                <div class="form-line">
                                    <label>Tags:</label>
                                    <br />
                                    <input type="text" class="form-control" data-role="tagsinput" />
                                </div>
                            </div>
                        </div>
                    </div>*@


            </div>

            <div class="modal-footer">
                <button onclick="ExecutarPostarPerguntaForum()" type="button" class="btn btn-link waves-effect">PERGUNTAR</button>
                <button type="button" class="btn btn-link waves-effect" data-dismiss="modal">FECHAR</button>
            </div>

        </div>
    </div>
</div>
<!-- #MODAL - + Perguntar -->

<!-- MODAL - Responder Pergunta -->
<div id="ComponentModalPerguntar">

</div>
<!-- #MODAL - Responder Pergunta -->

<script>

    // Realizar Post de Pergunta no Fórum
    function ExecutarPostarPerguntaForum() {

        // Autor Usuário Pergunta


        // Título da Pergunta
        var vTituloPerguntaForum = $("#idTituloPerguntaForum").val();

        // Descrição Pergunta
        var vDescricaoPerguntaForum = $("#idDescricaoPerguntaForum").val();

        // Tags Pergunta
        var vTagsPerguntaForum = $("#idTagsPerguntaForum").val();

        // Data/Hora Realização Pergunta
        var vDataHoraRealizacaoPergunta = "";
        var d = new Date();
        var dataRealizacaoPergunta = (d.toLocaleDateString());
        var horaRealizacaoPergunta = addZero(d.getHours());
        var minutoRealizacaoPergunta = addZero(d.getMinutes());
        vDataHoraRealizacaoPergunta = dataRealizacaoPergunta.concat(" - ", horaRealizacaoPergunta, ":", minutoRealizacaoPergunta);

        // JSON
        var DadosPergunta = {};

        DadosPergunta.TituloPerguntaForum = vTituloPerguntaForum;
        DadosPergunta.DescricaoPerguntaForum = vDescricaoPerguntaForum;
        DadosPergunta.TagsPerguntaForum = vTagsPerguntaForum;
        DadosPergunta.DataHoraRealizacaoPerguntaForum = vDataHoraRealizacaoPergunta;

        var url = '/Home/PostarPerguntaForum';
        $.ajax({
            type: "POST",
            url: url,
            contentType: 'application/json; charset=utf-8',
            dataType: 'html',
            data: JSON.stringify(DadosPergunta),

            success: function (message) {
                $('#idModalPerguntar').modal('hide');
                $('#idDivPrincipalForumDeDuvidas').html(message);
            },

            error: function () {
                alert('Ops, Ocorreu um erro !');
            }
        });
    }

    // Data/Hora Realização Pergunta | Formatação
    function addZero(i) {
        if (i < 10) {
            i = "0" + i;
        }
        return i;
    }

    function AtualizarTopicosRecentes() {

        window.setTimeout(function () {

            var url = '/Home/AtualizarTopicosRecentes';
            $.ajax({
                type: "POST",
                url: url,
                contentType: 'application/json; charset=utf-8',
                dataType: 'html',
                //data: JSON.stringify(DadosPergunta),

                success: function (message) {
                    $('#idDivPrincipalForumDeDuvidas').html(message);
                },

                error: function () {
                    alert('Ops, Ocorreu um erro !');
                }
            });

        }, 1000);

        // onclick="javascript:location.reload()"
        //location.reload();
    }

    // Realizar Post de Resposta no Fórum
    function ExecutarAbrirModalPergunta(idPergunta) {

        var url = '/Home/AbrirModalPergunta';
        var stringReqdata = JSON.stringify(idPergunta);

        $.ajax({
            type: "POST",
            url: url,
            contentType: 'application/json; charset=utf-8',
            dataType: 'html',

            //contentType: false,
            //processData: false,

            data: stringReqdata,
            success: function (message) {
                $('#ComponentModalPerguntar').html(message);
            },

            error: function () {
                alert('error');
            }
        });

    }

</script>